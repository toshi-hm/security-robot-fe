# 2. 学習 (Training)

このセクションでは、強化学習セッションの開始、実行中のセッションの監視、および詳細なメトリクスの確認方法について説明します。

## 2.1. 学習セッション一覧ページ (`/training`)

新しい学習セッションを開始したり、既存の学習セッションの概要を確認したりするページです。

### ページ構成

*   **新規学習セッション設定**:
    *   ページ上部に「新規学習セッションを開始」するためのフォームが配置されています。
    *   セッション名、学習アルゴリズム（PPO, A3Cなど）、環境タイプ（標準、拡張）、総タイムステップ、環境の幅と高さ、報酬の重み（カバレッジ、探索、多様性）などのパラメータを設定できます。
    *   各入力フィールドには詳細なツールチップが表示され、設定内容を理解するのに役立ちます。
    *   フォームの入力が完了したら、「学習を開始」ボタンをクリックしてセッションを開始します。
    *   セッション開始後、自動的にそのセッションの詳細ページへ遷移します。
*   **アクティブセッション一覧**:
    *   現在システムに存在する学習セッションが一覧表示されます。
    *   **ID**: セッションの一意の識別子。
    *   **セッション名**: ユーザーが設定したセッションの名前。
    *   **アルゴリズム**: 学習に使用されているアルゴリズム。
    *   **ステータス**: セッションの現在の状態（例: 実行中、一時停止、完了、失敗、作成済み）。色分けされたタグで表示されます。
    *   **進捗**: 学習の完了度合いをパーセンテージで表示するプログレスバー。
    *   **タイムステップ**: 現在のタイムステップと総タイムステップ。
    *   **エピソード数**: 完了したエピソードの数。
    *   **操作**: 「詳細を表示」ボタン。
    *   テーブルの行をクリックするか、「詳細を表示」ボタンをクリックすると、そのセッションの詳細ページへ移動します。
    *   右上の「更新」ボタンをクリックすると、最新のセッションリストが取得されます。
    *   セッションが見つからない場合は、「学習セッションが見つかりません」というメッセージが表示されます。

### 操作方法

1.  **新規学習セッションの開始**:
    1.  「新規学習セッション設定」フォームで、必要なパラメータを入力します。
    2.  各パラメータの詳細については、入力フィールド横のアイコンにカーソルを合わせると表示されるツールチップを参照してください。
    3.  「学習を開始」ボタンをクリックします。
    4.  セッションが正常に開始されると、自動的にそのセッションの詳細ページに移動します。
2.  **既存セッションの詳細確認**:
    1.  「アクティブセッション一覧」テーブルから、詳細を確認したいセッションの行をクリックするか、「詳細を表示」ボタンをクリックします。
    2.  選択したセッションのリアルタイムメトリクスと環境可視化が表示される詳細ページへ移動します。
3.  **セッションリストの更新**:
    1.  「アクティブセッション一覧」の右上にある「更新」ボタンをクリックすると、最新のセッション情報が取得され、テーブルが更新されます。

## 2.2. 学習セッション詳細ページ (`/training/:sessionId`)

特定の学習セッションのリアルタイムな進捗、メトリクス、および環境の状態を詳細に確認するページです。

### ページ構成

*   **ヘッダー**:
    *   セッションIDとWebSocket接続の状態（「WebSocket Connected」または「Disconnected」）が表示されます。
    *   接続エラーやトレーニングステータス、エラーメッセージはページ上部にアラートとして表示されます。
*   **リアルタイムメトリクス**:
    *   学習の主要なメトリクス（タイムステップ、エピソード、報酬、損失、カバレッジ率、探索スコア）がリアルタイムでグラフ表示されます。
    *   各メトリクスの数値も表示され、学習の進捗を詳細に把握できます。
*   **環境可視化**:
    *   ロボットが学習している環境の2Dマップが表示されます。
    *   **脅威レベルヒートマップ**: 環境内の脅威レベルが色（黄〜赤）で示されます。
    *   **カバレッジオーバーレイ**: ロボットが訪問した領域が緑色の半透明で表示されます。
    *   **ロボットの位置**: ロボットの現在位置が青い円で表示され、移動経路が線で示されます。
    *   **ズーム/パン**: マウスホイールでズームイン/アウト、ドラッグでマップをパン（移動）できます。
    *   **凡例**: 脅威レベルとカバレッジの状態を示す凡例が表示されます。
*   **環境状態**:
    *   ロボットの現在位置（X, Y座標）、最後のアクション、最後の報酬などの詳細情報が表示されます。

### 操作方法

1.  **リアルタイムデータの監視**:
    1.  ページにアクセスすると、WebSocketを通じてバックエンドからリアルタイムデータがストリーミングされ、メトリクスグラフと環境可視化が自動的に更新されます。
    2.  学習の進捗に応じて、グラフのデータポイントが追加され、ロボットの位置やカバレッジマップが変化します。
2.  **環境マップの操作**:
    1.  **ズーム**: マウスホイールをスクロールすると、環境マップを拡大・縮小できます。
    2.  **パン**: マウスの左ボタンをドラッグすると、マップを移動できます。
3.  **アラートの確認**:
    1.  トレーニングのステータス変更やエラーが発生した場合、ページ上部にアラートが表示されます。
    2.  エラーアラートは自動的に閉じませんが、ステータスアラートは5秒後に自動的に閉じます（手動で閉じることも可能です）。
